<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Recipe</title>
  <link href="sanfrancisco-font.css" rel="stylesheet" type="text/css" />
  <link href="index.css" rel="stylesheet" type="text/css" />
  <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const Header = (props) =>
      <div class="header">
        <h1>{props.title}</h1>
      </div>

    const Recipe = (props) =>
      <div class="recipe-container">
        <div class="recipe-img-content">
          <img src={props.image} />
          <div class="recipe-rating">{props.rating}</div>
        </div>
        <div class="recipe-content">
          <span class="recipe-title overflow-ellipsis">{props.name}</span>
          <span class="recipe-author overflow-ellipsis">By. {props.creator}</span>
          <p class="recipe-short-description">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam convallis mauris in est eleifend sodales. Ut nisi est, vestibulum at massa non, vehicula dignissim nisl. Duis bibendum nulla vitae est eleifend euismod. Proin faucibus nulla vel laoreet malesuada. Quisque accumsan quam nec odio rhoncus, quis bibendum augue malesuada. Fusce pellentesque venenatis neque efficitur ultricies. Aliquam erat volutpat. Suspendisse eu mauris consequat magna molestie sodales vitae id ligula. Nam sed dui elit. Proin magna risus, posuere eget aliquet sit amet, laoreet ut ante. Sed quis massa nulla. Aliquam mattis dolor sed laoreet fermentum. Donec non mauris nunc.
          </p>
        </div>
      </div>

    class RecipeApp extends React.Component {
      render() {
        return (
          <>
            <Header title="Recipe" />
            <div class="recipe-list">
              {this.props.recipes.map(recipe => <Recipe {...recipe} />)}
            </div>
          </>
        );
      }
    }
  </script>

  <script type="text/babel">
    const getRecipes = () => new Promise((resolve, reject) => {
      const handleError = err => {
        console.error(err);
      }

      const _getRecipes = fetch('/recipe.json');

      _getRecipes.catch(err => {
        console.error(err);
        return reject(err);
      });

      _getRecipes
        .then(response => response.json())
        .then(result => {
          const recipes = result && result.recipe || [];
          const hasChicken = recipe => (recipe.ingredients || []).indexOf('Chicken') >= 0;
          return resolve(recipes.filter(hasChicken));
        });
    });

    const startApp = (recipes) =>
      ReactDOM.render(
        <RecipeApp recipes={recipes} />,
        document.getElementById('root')
      );

    getRecipes().then(startApp);
  </script>
</body>
</html>
